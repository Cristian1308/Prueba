<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Odómetro de Ventas y Presupuesto</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@800&display=swap" rel="stylesheet">
<style>
  body, html {
    height: 100%;
    margin: 0;
    padding: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    font-family: 'Montserrat', sans-serif;
    background-image: url("DEGRADE JDD.jpg");
  }

  .container {
    text-align: center;
    padding: 20px;
  }

  .logo {
    max-width: 100%;
    height: auto;
  }

  .title {
    color: #333;
    font-size: 2em;
    margin: 20px 0;
  }

  .odometer, .currency {
    display: flex;
    justify-content: center;
    align-items: center;
  }

  .digit, .currency {
    color: #000;
    margin: 0 5px;
    font-size: 5em;
    font-weight: 800;
  }

  @media (max-width: 768px) {
    .digit, .currency {
      font-size: 3em;
    }
    .logo {
      width: 50%; /* Ajustar según necesidad */
    }
  }

  @media (max-width: 480px) {
    .digit, .currency {
      font-size: 2em;
    }
    .logo {
      width: 70%; /* Ajustar según necesidad */
    }
  }
</style>
</head>
<body>

<div class="container">
  <img src="LOGO JDD BLANCO.png" alt="Logo" class="logo">
  <div class="title">Ventas</div>
  <div class="odometer">
    <div class="digit" id="salesDigit1">0</div>
    <div class="digit" id="salesDigit2">0</div>
    <div class="digit" id="salesDigit3">0</div>
  </div>

  <div class="title">Presupuesto</div>
  <div class="odometer">
    <div class="currency">$</div>
    <div class="digit" id="budgetDigit1">0</div>
    <div class="digit" id="budgetDigit2">0</div>
    <div class="digit" id="budgetDigit3">0</div>
    <div class="digit" id="budgetDigit4">0</div>
    <div class="digit" id="budgetDigit5">0</div>
    <div class="digit" id="budgetDigit6">0</div>
  </div>
</div>

<script>
function randomDigit() {
  return Math.floor(Math.random() * 10);
}

function updateOdometerDisplay(idPrefix, value, minLength) {
  const valueStr = value.toString().padStart(minLength, '0');
  for (let i = 0; i < minLength; i++) {
    const digitId = `${idPrefix}${i+1}`;
    document.getElementById(digitId).textContent = valueStr[i];
  }
}

function confuseBeforeReveal(idPrefix, minLength, duration, targetValue) {
  const endTime = Date.now() + duration;
  function updateRandomly() {
    if (Date.now() < endTime) {
      for (let i = 0; i < minLength; i++) {
        const digitId = `${idPrefix}${i+1}`;
        document.getElementById(digitId).textContent = randomDigit();
      }
      requestAnimationFrame(updateRandomly);
    } else {
      // Revela el valor final
      updateOdometerDisplay(idPrefix, targetValue, minLength);
    }
  }
  updateRandomly();
}

async function loadValueFromAppsScript() {
  const scriptUrl = 'https://script.google.com/macros/s/AKfycbyhuzTHRWG8t6mJJuAfY5-y-C7xx8XVK5kJVyiRh_yZpFbpwpcV4SO0yg6Ch5uFziXo/exec';
  try {
    const response = await fetch(scriptUrl);
    const data = await response.json(); // Asume que el script devuelve un objeto JSON

    if(data && !isNaN(data.ventas) && data.ventas >= 0 && data.ventas <= 999) {
      confuseBeforeReveal('salesDigit', 3, 2000, data.ventas); // 2 segundos de confusión para las ventas
    } else {
      console.error("El valor de ventas obtenido no es válido.");
    }

    if(data && !isNaN(data.presupuesto) && data.presupuesto >= 0) {
      updateOdometerDisplay('budgetDigit', data.presupuesto, 6); // Presupuesto actualizado directamente sin animación
    } else {
      console.error("El valor de presupuesto obtenido no es válido.");
    }
  } catch (error) {
    console.error('Error al cargar los datos de Apps Script:', error);
  }
}

window.onload = function() {
  loadValueFromAppsScript();
};
</script>

</body>
</html>

